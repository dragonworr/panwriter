<html>
<head>
<style>
  body {
    margin: 0;
  }

  .pagedjs_pages {
    overflow: scroll;
    padding: 50px;
  }

  .pagedjs_page {
    background-color: white;
    margin: 0 auto;
    margin-bottom: 50px;
  }
</style>
</head>
<body>
  <script src="previewFrame.bundle.js"></script>
  <script>
  "use strict"
  
  let style, previewer;
  function render(content, cssStr) {
    if (style) {
      style.remove();
    }
    if (previewer) {
      previewer.chunker.pageTemplate.remove();
      previewer.polisher.destroy();
    }

    let renderTo = document.body;
    previewer = new Previewer();

    previewer.polisher.setup();
    style = previewer.polisher.insert("");

    let chunker = new Chunker();
    previewer.chunker = chunker;
    chunker.setup(renderTo);

    previewer.initializeHandlers();

    previewer.polisher.convertViaSheet(cssStr, "").then(text => {
      style.innerHTML = text;
      chunker.reflow(content);
    });
  }
  //function render(content, cssStr) {
  //  previewer.preview(content, ["foo.css"], renderTo);
  //}
  </script>
</body>
</html>